!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/platform-browser"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-doc-viewer",["exports","@angular/core","@angular/platform-browser","@angular/common"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-doc-viewer"]={},e.ng.core,e.ng.platformBrowser,e.ng.common)}(this,(function(e,r,n,t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function o(e,r,n,t){return new(n||(n=Promise))((function(o,i){function a(e){try{s(t.next(e))}catch(e){i(e)}}function l(e){try{s(t.throw(e))}catch(e){i(e)}}function s(e){var r;e.done?o(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,l)}s((t=t.apply(e,r||[])).next())}))}function i(e,r){var n,t,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=r.call(e,a)}catch(e){i=[6,e],t=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}Object.create;Object.create;var a=function(e){return new Promise((function(r,n){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){var e=new FileReader;e.readAsArrayBuffer(t.response),e.onloadend=function(){r(e.result)}},t.send()}catch(r){n("error while retrieving file "+e+".")}}))},l=function(e){e&&(console.log("reloading.."),e.src=e.src)},s=l,u=function(e){var r=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return r&&{href:e,protocol:r[1],host:r[2],hostname:r[3],port:r[4],pathname:r[5],search:r[6],hash:r[7]}},c=function(e){return o(void 0,void 0,void 0,(function(){var r;return i(this,(function(n){switch(n.label){case 0:return mammoth||console.error("Please install mammoth and make sure mammoth.browser.min.js is loaded."),[4,a(e)];case 1:return r=n.sent(),[4,mammoth.convertToHtml({arrayBuffer:r})];case 2:return[2,n.sent().value]}}))}))},d=function(){var e=null,r=0;return{subscribe:function(n,t,o){if(void 0===t&&(t=3e3),void 0===o&&(o=5),!f(n))return e=setInterval((function(){++r>=o&&clearInterval(e),l(n)}),t);e&&clearInterval(e)},unsubscribe:function(){e&&clearInterval(e)}}},f=function(e){var r,n=!1;try{n=h()?!(null===(r=null==e?void 0:e.contentWindow)||void 0===r?void 0:r.document):!(null==e?void 0:e.contentDocument)}catch(e){}return n},h=function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)||navigator.userAgent.indexOf("Trident/")>-1},p=h,v=function(e,r,n,t){switch(void 0===r&&(r="google"),void 0===n&&(n=""),void 0===t&&(t=""),r){case"google":t="https://docs.google.com/gview?url=%URL%&embedded=true";break;case"office":t="https://view.officeapps.live.com/op/embed.aspx?src=%URL%";break;case"pdf":t=""}var o="google"===r||"office"===r||"url"===r,i=e.indexOf("/")?encodeURIComponent(e):e,a=t?t.replace("%URL%",i):e;n&&o&&"url"!==r&&(a=""+a+(n.startsWith("&")?"":"&")+n);return{url:a,externalViewer:o}},g=function(e,r){var n=u(e),t=u(r);return n&&t?e.replace(n.port?n.hostname+":"+n.port:n.hostname,t.port?t.hostname+":"+t.port:t.hostname):e},m=function(e){return new Promise((function(r,n){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){r(t.response)},t.onerror=n,t.send()}))},w=m,b=function(e){var r=u(e),n=(null==r?void 0:r.hostname)||"";return["localhost","127.0.0.1","","::1"].includes(n)||n.startsWith("192.168.")||n.startsWith("10.0.")||n.endsWith(".local")},y=function(){function e(e,n){this.domSanitizer=e,this.ngZone=n,this.loaded=new r.EventEmitter,this.url="",this.queryParams="",this.viewerUrl="",this.googleCheckInterval=3e3,this.googleMaxChecks=5,this.disableContent="none",this.googleCheckContentLoaded=!0,this.fullUrl=null,this.externalViewer=!1,this.docHtml="",this.configuredViewer="google",this.shouldCheckIframe=!1}return e.prototype.ngAfterViewInit=function(){var e,r;if(this.shouldCheckIframe){var n=null===(r=null===(e=this.iframes)||void 0===e?void 0:e.first)||void 0===r?void 0:r.nativeElement;n&&(this.shouldCheckIframe=!1,this.reloadIframe(n))}},e.prototype.ngOnDestroy=function(){this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe()},e.prototype.ngOnChanges=function(e){return o(this,void 0,void 0,(function(){var r,n,t,o=this;return i(this,(function(i){switch(i.label){case 0:return e&&e.viewer&&(e.viewer.isFirstChange||e.viewer.currentValue!==e.viewer.previousValue)&&("google"!==this.viewer&&"office"!==this.viewer&&"mammoth"!==this.viewer&&"pdf"!==this.viewer&&"url"!==this.viewer&&console.error("Unsupported viewer: '"+this.viewer+"'. Supported viewers: google, office, mammoth and pdf"),this.configuredViewer=this.viewer),e.url&&e.url.currentValue!==e.url.previousValue||e.viewer&&e.viewer.currentValue!==e.viewer.previousValue||e.viewerUrl&&e.viewerUrl.currentValue!==e.viewerUrl.previousValue?(r=v(this.url,this.configuredViewer,this.queryParams,this.viewerUrl),this.externalViewer=r.externalViewer,r.externalViewer&&this.overrideLocalhost&&b(this.url)&&(n=g(this.url,this.overrideLocalhost),r=v(n,this.configuredViewer,this.queryParams,this.viewerUrl)),this.docHtml="",this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe(),this.url?[3,1]:(this.fullUrl=null,[3,4])):[3,4];case 1:return r.externalViewer||"url"===this.configuredViewer?(this.fullUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(r.url),"google"===this.configuredViewer&&this.googleCheckContentLoaded&&this.ngZone.runOutsideAngular((function(){var e,r,n=null===(r=null===(e=o.iframes)||void 0===e?void 0:e.first)||void 0===r?void 0:r.nativeElement;n?o.reloadIframe(n):o.shouldCheckIframe=!0})),[3,4]):[3,2];case 2:return"mammoth"!==this.configuredViewer?[3,4]:(t=this,[4,c(this.url)]);case 3:t.docHtml=i.sent(),i.label=4;case 4:return[2]}}))}))},e.prototype.reloadIframe=function(e){this.checkIFrameSubscription=d(),this.checkIFrameSubscription.subscribe(e,this.googleCheckInterval,this.googleMaxChecks)},e.prototype.iframeLoaded=function(){var e,r,n=null===(r=null===(e=this.iframes)||void 0===e?void 0:e.first)||void 0===r?void 0:r.nativeElement;n&&f(n)&&(this.loaded.emit(null),this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe())},e}();y.decorators=[{type:r.Component,args:[{selector:"ngx-doc-viewer",template:'<ng-container *ngIf="!externalViewer">\r\n  <div *ngIf="configuredViewer !== \'pdf\'" [innerHtml]="docHtml"></div>\r\n  <object\r\n    *ngIf="fullUrl && configuredViewer === \'pdf\'"\r\n    [data]="fullUrl"\r\n    type="application/pdf"\r\n    width="100%"\r\n    height="100%"\r\n  >\r\n    <p>\r\n      Your browser does not support PDFs.\r\n      <a [href]="fullUrl">Download the PDF</a>.\r\n    </p>\r\n  </object>\r\n</ng-container>\r\n<ng-container *ngIf="externalViewer">\r\n  <iframe\r\n    (load)="iframeLoaded()"\r\n    *ngIf="fullUrl && disableContent === \'none\'"\r\n    #iframe\r\n    id="iframe-doc-viewer"\r\n    frameBorder="0"\r\n    [src]="fullUrl"\r\n  ></iframe>\r\n  <div class="container" *ngIf="disableContent !== \'none\'">\r\n    <div\r\n      [class.overlay-full]="disableContent === \'all\'"\r\n      [class.overlay-popout-google]="\r\n        configuredViewer === \'google\' &&\r\n        (disableContent === \'popout\' || disableContent === \'popout-hide\')\r\n      "\r\n      [class.overlay-popout-office]="\r\n        configuredViewer === \'office\' &&\r\n        (disableContent === \'popout\' || disableContent === \'popout-hide\')\r\n      "\r\n      [style.background-color]="\r\n        disableContent === \'popout-hide\' ? \'#fff\' : \'transparent\'\r\n      "\r\n    ></div>\r\n    <iframe\r\n      (load)="iframeLoaded()"\r\n      *ngIf="fullUrl"\r\n      #iframe\r\n      id="iframe"\r\n      frameBorder="0"\r\n      [src]="fullUrl"\r\n    ></iframe>\r\n  </div>\r\n</ng-container>\r\n',styles:["\n      :host {\n        display: block;\n      }\n      .container {\n        width: 100%;\n        height: 100%;\n        position: relative;\n      }\n      .overlay-popout-google {\n        width: 40px;\n        height: 40px;\n        right: 26px;\n        top: 11.5px;\n        position: absolute;\n        z-index: 1000;\n      }\n      .overlay-popout-office {\n        width: 100px;\n        height: 20px;\n        right: 0;\n        bottom: 0;\n        position: absolute;\n        z-index: 1000;\n      }\n      .overlay-full {\n        width: 100%;\n        height: 100%;\n        right: 0;\n        top: 0;\n        position: absolute;\n        z-index: 1000;\n      }\n      iframe {\n        width: 100%;\n        height: 100%;\n      }\n    "]}]}],y.ctorParameters=function(){return[{type:n.DomSanitizer},{type:r.NgZone}]},y.propDecorators={loaded:[{type:r.Output}],url:[{type:r.Input}],queryParams:[{type:r.Input}],viewerUrl:[{type:r.Input}],googleCheckInterval:[{type:r.Input}],googleMaxChecks:[{type:r.Input}],disableContent:[{type:r.Input}],googleCheckContentLoaded:[{type:r.Input}],viewer:[{type:r.Input}],overrideLocalhost:[{type:r.Input}],iframes:[{type:r.ViewChildren,args:["iframe"]}]};var I=function(){};I.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule],declarations:[y],exports:[y]}]}];var x={loaded:function(){},disableContent:"none",googleCheckContentLoaded:!0,googleCheckInterval:3e3,queryParams:"",url:"",viewer:"google",viewerUrl:""};e.NgxDocViewerComponent=y,e.NgxDocViewerModule=I,e.defaultProps=x,e.fileToArray=a,e.getDocxToHtml=c,e.getLocation=u,e.getViewerDetails=v,e.getbaseUrl=function(){var e=window.location.href.split("/");return e[0]+"//"+e[2]},e.googleCheckSubscription=d,e.handleFileUpload=function(e){return new Promise((function(r,n){if(e.target.files&&e.target.files[0]){var t=new FileReader;t.onload=function(e){r(e.target.result)},t.readAsDataURL(e.target.files[0])}else n("no files selected")}))},e.iframeIsLoaded=f,e.isLocalFile=b,e.replaceLocalUrl=g,e.uploadToCloud=function(e,r){return new Promise((function(n,t){m(e).then((function(o){var i,a,l=u(e),s=(null==l?void 0:l.pathname)?null===(i=null==l?void 0:l.pathname)||void 0===i?void 0:i.split("/")[(null===(a=null==l?void 0:l.pathname)||void 0===a?void 0:a.split("/").length)-1]:"",c=new FormData,d=new XMLHttpRequest;c.append("file",o,s),d.onreadystatechange=function(e){d.readyState===XMLHttpRequest.DONE&&(200===d.status?n(d.responseText):t(d.responseText))},d.onerror=t,d.open("post",r,!0),d.send(c)}))}))},e.ɵ0=s,e.ɵ1=p,e.ɵ2=w,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-doc-viewer.umd.min.js.map